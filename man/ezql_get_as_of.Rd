% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sql.R
\name{ezql_get_as_of}
\alias{ezql_get_as_of}
\title{Retrieve Data as of a Specific Date}
\usage{
ezql_get_as_of(table, as_of, schema = NULL, database = NULL, address = NULL)
}
\arguments{
\item{table}{Character. The name of the table to query.}

\item{as_of}{Character or Date. The date to filter the records on. Must be
in a format recognized by `lubridate::ymd`.}

\item{schema}{Character (optional). The schema containing the table.
Defaults to the value from `ezql_details_schema()`.}

\item{database}{Character (optional). The database containing the schema.
Defaults to the value from `ezql_details_db()`.}

\item{address}{Character (optional). The server address. Defaults to the
value from `ezql_details_add()`.}
}
\value{
A data frame (tibble) containing the records from the table and its history
  as of the given date. The records will include only rows where the `as_of` date
  falls between the `ValidFrom` and `ValidTo` columns.
}
\description{
This function retrieves records from a specified table and its history,
ensuring that all fields are properly type-aligned before filtering them
by the specified `as_of` date. It uses internal details to fill in
missing schema, database, or address values if they are not explicitly provided.
}
\details{
The function combines current and historical records from the specified table. It first
retrieves the data from the main table and a corresponding `_history` table. It then
ensures that the data types of all shared columns match before merging the records.
Finally, it filters the combined data to return only the records valid at the `as_of` date.

If any of `schema`, `database`, or `address` are not provided, the function will attempt
to obtain their values from the `ezql_details_*` functions. If these are not defined,
the function will throw an error.

The function internally uses the following helper functions:
- `convert_to_same_class_vec()` for column-wise type alignment
- `convert_to_same_class()` for data frame-level type alignment
}
\examples{
\dontrun{
# Example usage:
result <- ezql_get_as_of(
  table = "my_table",
  as_of = "2025-03-01",
  schema = "my_schema",
  database = "my_database",
  address = "my_server_address"
)
}

}
